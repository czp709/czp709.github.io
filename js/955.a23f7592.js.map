{"version":3,"file":"js/955.a23f7592.js","mappings":"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","sources":["webpack://vue/./src/views/MenuManage/MenuManage.vue","webpack://vue/src/views/MenuManage/MenuManage.vue","webpack://vue/./src/views/MenuManage/MenuManage.vue?9846","webpack://vue/./src/views/MenuManage/MenuManage.vue?1e9a","webpack://vue/./src/views/MenuManage/components/MenuForm.vue","webpack://vue/src/views/MenuManage/components/MenuForm.vue","webpack://vue/./src/views/MenuManage/components/MenuForm.vue?cb9e","webpack://vue/./src/views/MenuManage/components/MenuForm.vue?9577","webpack://vue/./src/api/menu.js","webpack://vue/./src/views/MenuManage/index.js"],"sourcesContent":["var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"page\"},[_c('div',{staticClass:\"tree-box\"},[_c('el-tree',{attrs:{\"data\":_vm.tree,\"node-key\":\"menuId\",\"draggable\":\"\",\"default-expanded-keys\":[0],\"expand-on-click-node\":false,\"props\":_vm.defaultProps},on:{\"node-click\":_vm.handleNodeClick,\"node-drop\":_vm.onNodeDrop},scopedSlots:_vm._u([{key:\"default\",fn:function({ data }){return _c('span',{staticClass:\"tree-line\"},[_c('span',{staticClass:\"iconStr\"},[(data.menuType == 'M')?_c('i',{staticClass:\"el-icon-folder icon\"}):_vm._e(),(data.menuType == 'C')?_c('i',{staticClass:\"el-icon-document icon\"}):_vm._e(),_c('TextTooltip',{attrs:{\"content\":data.menuName}})],1),_c('span',{staticClass:\"icons\"},[_c('i',{staticClass:\"el-icon-circle-plus-outline icon\",staticStyle:{\"margin-right\":\"8px\"},attrs:{\"title\":\"新增\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.addMenu(data)}}}),_c('i',{staticClass:\"el-icon-delete icon\",attrs:{\"title\":\"删除\"},on:{\"click\":function($event){$event.stopPropagation();return _vm.deleteMenu(data)}}})])])}}])})],1),_c('div',{staticClass:\"table\"},[(_vm.showForm)?_c('MenuForm',{ref:\"MenuForm\",attrs:{\"menu-tree\":_vm.tree},on:{\"reload\":_vm.getMenu,\"close\":_vm.close}}):_c('el-empty',{attrs:{\"description\":\"左侧选择父级新增\"}})],1)])\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"page\">\n    <div class=\"tree-box\">\n      <el-tree\n        :data=\"tree\"\n        node-key=\"menuId\"\n        draggable\n        :default-expanded-keys=\"[0]\"\n        :expand-on-click-node=\"false\"\n        :props=\"defaultProps\"\n        @node-click=\"handleNodeClick\"\n        @node-drop=\"onNodeDrop\">\n        <span slot-scope=\"{ data }\" class=\"tree-line\">\n          <span class=\"iconStr\">\n            <i v-if=\"data.menuType == 'M'\" class=\"el-icon-folder icon\"></i>\n            <i v-if=\"data.menuType == 'C'\" class=\"el-icon-document icon\"></i>\n            <TextTooltip :content=\"data.menuName\"></TextTooltip>\n          </span>\n          <span class=\"icons\">\n            <i\n              title=\"新增\"\n              class=\"el-icon-circle-plus-outline icon\"\n              style=\"margin-right: 8px\"\n              @click.stop=\"addMenu(data)\"></i>\n            <i\n              title=\"删除\"\n              class=\"el-icon-delete icon\"\n              @click.stop=\"deleteMenu(data)\"></i>\n          </span>\n        </span>\n      </el-tree>\n    </div>\n    <div class=\"table\">\n      <MenuForm\n        v-if=\"showForm\"\n        ref=\"MenuForm\"\n        :menu-tree=\"tree\"\n        @reload=\"getMenu\"\n        @close=\"close\"></MenuForm>\n      <el-empty v-else description=\"左侧选择父级新增\"></el-empty>\n    </div>\n  </div>\n</template>\n<script>\nimport array2Tree from '@/utils/index'\nimport { cloneDeep } from 'lodash'\nimport MenuForm from './components/MenuForm'\nimport { deleteMenu, getMenuTree, sortMenu } from '@/api/menu'\nexport default {\n  name: 'MenuMange',\n  components: {\n    MenuForm,\n  },\n  data() {\n    return {\n      tree: null,\n      menu: null,\n      defaultProps: {\n        label: 'menuName',\n        children: 'children',\n      },\n      showForm: false,\n    }\n  },\n  created() {\n    this.getMenu()\n  },\n  methods: {\n    getMenu() {\n      getMenuTree().then((res) => {\n        const tree = [\n          {\n            menuId: 0,\n            menuName: '根目录',\n            menuType: 'M',\n            children: [],\n          },\n        ]\n        tree[0].children = array2Tree(cloneDeep(res.data), { id: 'menuId' })\n        this.tree = tree\n      })\n    },\n    handleNodeClick(node) {\n      if (node.menuId == 0) {\n        return\n      }\n      this.showForm = true\n      this.$nextTick(() => {\n        this.$refs.MenuForm.editMenu(node.menuId)\n      })\n    },\n    addMenu(data) {\n      this.showForm = true\n      const sort = data.children?.length || 0\n      this.$nextTick(() => {\n        this.$refs.MenuForm.addMenu(data, sort + 1)\n      })\n    },\n    close() {\n      this.showForm = false\n    },\n    deleteMenu(data) {\n      if (data.menuId == 0) {\n        return\n      }\n      deleteMenu({ menuId: data.menuId }).then(() => {\n        this.getMenu()\n        if (data.menuId == this.$refs.MenuForm.ruleForm.menuId) {\n          this.close()\n        }\n      })\n    },\n    onNodeDrop(node, insertNode, position) {\n      let parentNode\n      if (position !== 'inner') {\n        parentNode = insertNode.parent.data\n      } else {\n        parentNode = insertNode.data\n      }\n      const parentId = parentNode.menuId\n      const childSort = parentNode.children.map((item, index) => {\n        return {\n          id: item.menuId,\n          orderNum: index + 1,\n        }\n      })\n      sortMenu(parentId, childSort).catch(() => {\n        this.getMenu()\n      })\n    },\n  },\n}\n</script>\n<style scoped lang=\"less\">\n.page {\n  width: 100%;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n}\n.tree-box {\n  width: 300px;\n  box-shadow: 1px 0 6px rgba(0, 0, 0, 0.2);\n  padding: 16px;\n  margin-right: 16px;\n  height: calc(~'100% - 32px');\n}\n.table {\n  display: flex;\n  flex-direction: column;\n  flex: 1;\n  height: 100%;\n  box-shadow: 1px 0 6px rgba(0, 0, 0, 0.2);\n}\n/deep/.el-tree-node__content {\n  box-sizing: border-box;\n}\n.tree-line {\n  box-sizing: border-box;\n  width: calc(~'100% - 24px');\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between !important;\n  position: relative;\n}\n\n/deep/.iconStr {\n  width: calc(~'100% - 40px') !important;\n  display: flex;\n  align-items: center;\n  font-size: 14px;\n  .icon {\n    font-size: 16px;\n    margin-right: 4px;\n  }\n}\n/deep/.icons {\n  display: flex;\n  flex-direction: row !important;\n  align-items: center;\n  position: absolute;\n  right: 0;\n  top: 50%;\n  transform: translateY(-50%);\n  color: #2d8cf0;\n}\n</style>\n","import mod from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MenuManage.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MenuManage.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MenuManage.vue?vue&type=template&id=f73b6bfc&scoped=true&\"\nimport script from \"./MenuManage.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuManage.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuManage.vue?vue&type=style&index=0&id=f73b6bfc&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"f73b6bfc\",\n  null\n  \n)\n\nexport default component.exports","var render = function render(){var _vm=this,_c=_vm._self._c;return _c('div',{staticClass:\"MenuForm\"},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ruleForm,\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"名称\",\"prop\":\"menuName\"}},[_c('el-input',{model:{value:(_vm.ruleForm.menuName),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"menuName\", $$v)},expression:\"ruleForm.menuName\"}})],1),_c('el-form-item',{attrs:{\"label\":\"父菜单\",\"prop\":\"parentId\"}},[_c('el-cascader',{staticStyle:{\"width\":\"100%\"},attrs:{\"show-all-levels\":false,\"props\":_vm.defaultProps,\"options\":_vm.menuTree,\"clearable\":\"\",\"filterable\":\"\"},model:{value:(_vm.ruleForm.parentId),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"parentId\", $$v)},expression:\"ruleForm.parentId\"}})],1),_c('el-form-item',{attrs:{\"label\":\"显示顺序\",\"prop\":\"orderNum\"}},[_c('el-input-number',{staticStyle:{\"width\":\"100%\"},attrs:{\"disabled\":\"\",\"controls\":false},model:{value:(_vm.ruleForm.orderNum),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"orderNum\", $$v)},expression:\"ruleForm.orderNum\"}})],1),_c('el-form-item',{attrs:{\"label\":\"菜单类型\",\"prop\":\"menuType\"}},[_c('el-select',{staticStyle:{\"width\":\"100%\"},model:{value:(_vm.ruleForm.menuType),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"menuType\", $$v)},expression:\"ruleForm.menuType\"}},[_c('el-option',{attrs:{\"disabled\":_vm.parentType != 'M',\"label\":\"菜单\",\"value\":\"M\"}}),_c('el-option',{attrs:{\"disabled\":_vm.parentType == 'C',\"label\":\"非菜单\",\"value\":\"C\"}}),_c('el-option',{attrs:{\"label\":\"权限\",\"value\":\"F\",\"disabled\":_vm.parentType != 'C'}})],1)],1),_c('el-form-item',{attrs:{\"label\":\"路由地址\",\"prop\":\"path\"}},[_c('el-input',{model:{value:(_vm.ruleForm.path),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"path\", $$v)},expression:\"ruleForm.path\"}})],1),_c('el-form-item',{attrs:{\"label\":\"组件路径\",\"prop\":\"component\"}},[_c('el-input',{model:{value:(_vm.ruleForm.component),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"component\", $$v)},expression:\"ruleForm.component\"}})],1),_c('el-form-item',{attrs:{\"label\":\"组件参数\",\"prop\":\"query\"}},[_c('el-input',{model:{value:(_vm.ruleForm.query),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"query\", $$v)},expression:\"ruleForm.query\"}})],1),_c('el-form-item',{attrs:{\"label\":\"图标\",\"prop\":\"icon\"}},[_c('IconChooser',{model:{value:(_vm.ruleForm.icon),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"icon\", $$v)},expression:\"ruleForm.icon\"}})],1),_c('div',{staticClass:\"MenuForm-switch\"},[_c('el-form-item',{attrs:{\"label\":\"外链\",\"prop\":\"isFrame\"}},[_c('el-switch',{attrs:{\"active-value\":0,\"inactive-value\":1,\"active-text\":\"是\",\"inactive-text\":\"否\"},model:{value:(_vm.ruleForm.isFrame),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"isFrame\", $$v)},expression:\"ruleForm.isFrame\"}})],1),_c('el-form-item',{attrs:{\"label\":\"是否缓存\",\"prop\":\"isCache\"}},[_c('el-switch',{attrs:{\"active-value\":0,\"inactive-value\":1,\"active-text\":\"是\",\"inactive-text\":\"否\"},model:{value:(_vm.ruleForm.isCache),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"isCache\", $$v)},expression:\"ruleForm.isCache\"}})],1)],1),_c('div',{staticClass:\"MenuForm-switch\"},[_c('el-form-item',{attrs:{\"label\":\"菜单状态\",\"prop\":\"status\"}},[_c('el-switch',{attrs:{\"active-value\":0,\"inactive-value\":1,\"active-text\":\"启用\",\"inactive-text\":\"停用\"},model:{value:(_vm.ruleForm.status),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"status\", $$v)},expression:\"ruleForm.status\"}})],1),_c('el-form-item',{attrs:{\"label\":\"菜单显隐\",\"prop\":\"visible\"}},[_c('el-switch',{attrs:{\"active-value\":0,\"inactive-value\":1,\"active-text\":\"显示\",\"inactive-text\":\"隐藏\"},model:{value:(_vm.ruleForm.visible),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"visible\", $$v)},expression:\"ruleForm.visible\"}})],1)],1)],1),_c('div',{staticClass:\"MenuForm-action\"},[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleForm')}}},[_vm._v(\" 保存 \")]),_c('el-button',{on:{\"click\":function($event){return _vm.$emit('close')}}},[_vm._v(\"取消\")])],1)],1)\n}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\n  <div class=\"MenuForm\">\n    <el-form\n      ref=\"ruleForm\"\n      :model=\"ruleForm\"\n      :rules=\"rules\"\n      label-width=\"100px\"\n      class=\"demo-ruleForm\">\n      <el-form-item label=\"名称\" prop=\"menuName\">\n        <el-input v-model=\"ruleForm.menuName\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"父菜单\" prop=\"parentId\">\n        <el-cascader\n          v-model=\"ruleForm.parentId\"\n          style=\"width: 100%\"\n          :show-all-levels=\"false\"\n          :props=\"defaultProps\"\n          :options=\"menuTree\"\n          clearable\n          filterable></el-cascader>\n      </el-form-item>\n      <el-form-item label=\"显示顺序\" prop=\"orderNum\">\n        <el-input-number\n          v-model=\"ruleForm.orderNum\"\n          disabled\n          style=\"width: 100%\"\n          :controls=\"false\"></el-input-number>\n      </el-form-item>\n      <el-form-item label=\"菜单类型\" prop=\"menuType\">\n        <el-select v-model=\"ruleForm.menuType\" style=\"width: 100%\">\n          <el-option\n            :disabled=\"parentType != 'M'\"\n            label=\"菜单\"\n            value=\"M\"></el-option>\n          <el-option\n            :disabled=\"parentType == 'C'\"\n            label=\"非菜单\"\n            value=\"C\"></el-option>\n          <el-option\n            label=\"权限\"\n            value=\"F\"\n            :disabled=\"parentType != 'C'\"></el-option>\n        </el-select>\n      </el-form-item>\n      <el-form-item label=\"路由地址\" prop=\"path\">\n        <el-input v-model=\"ruleForm.path\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"组件路径\" prop=\"component\">\n        <el-input v-model=\"ruleForm.component\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"组件参数\" prop=\"query\">\n        <el-input v-model=\"ruleForm.query\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"图标\" prop=\"icon\">\n        <IconChooser v-model=\"ruleForm.icon\"></IconChooser>\n      </el-form-item>\n      <div class=\"MenuForm-switch\">\n        <el-form-item label=\"外链\" prop=\"isFrame\">\n          <el-switch\n            v-model=\"ruleForm.isFrame\"\n            :active-value=\"0\"\n            :inactive-value=\"1\"\n            active-text=\"是\"\n            inactive-text=\"否\"></el-switch>\n        </el-form-item>\n        <el-form-item label=\"是否缓存\" prop=\"isCache\">\n          <el-switch\n            v-model=\"ruleForm.isCache\"\n            :active-value=\"0\"\n            :inactive-value=\"1\"\n            active-text=\"是\"\n            inactive-text=\"否\"></el-switch>\n        </el-form-item>\n      </div>\n      <div class=\"MenuForm-switch\">\n        <el-form-item label=\"菜单状态\" prop=\"status\">\n          <el-switch\n            v-model=\"ruleForm.status\"\n            :active-value=\"0\"\n            :inactive-value=\"1\"\n            active-text=\"启用\"\n            inactive-text=\"停用\"></el-switch>\n        </el-form-item>\n        <el-form-item label=\"菜单显隐\" prop=\"visible\">\n          <el-switch\n            v-model=\"ruleForm.visible\"\n            :active-value=\"0\"\n            :inactive-value=\"1\"\n            active-text=\"显示\"\n            inactive-text=\"隐藏\"></el-switch>\n        </el-form-item>\n      </div>\n    </el-form>\n    <div class=\"MenuForm-action\">\n      <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">\n        保存\n      </el-button>\n      <el-button @click=\"$emit('close')\">取消</el-button>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { addMenu, getMenuInfo } from '@/api/menu'\nexport default {\n  name: 'MenuForm',\n  props: {\n    menuTree: {\n      type: Array,\n      default: () => {\n        return []\n      },\n    },\n  },\n  data() {\n    return {\n      ruleForm: {\n        menuName: '',\n        orderNum: null,\n        menuType: '',\n        path: '',\n        parentId: '0',\n        component: '',\n        query: '',\n        icon: 'el-icon-menu',\n        isFrame: 1,\n        isCache: 0,\n        status: 0,\n        visible: 0,\n      },\n      defaultProps: {\n        label: 'menuName',\n        children: 'children',\n        value: 'menuId',\n        emitPath: false,\n        checkStrictly: true,\n      },\n      parentType: '',\n    }\n  },\n  computed: {\n    rules() {\n      const validatePath = (rule, value, callback) => {\n        if (value === '') {\n          callback(new Error('请输入路由地址'))\n        } else {\n          callback()\n        }\n      }\n      const validateComponent = (rule, value, callback) => {\n        if (value === '') {\n          callback(new Error('请输入组件地址'))\n        } else {\n          callback()\n        }\n      }\n      const rules = {\n        menuName: [\n          { required: true, message: '请输入菜单名称', trigger: 'blur' },\n          {\n            min: 1,\n            max: 50,\n            message: '长度在 1 到 50 个字符',\n            trigger: 'blur',\n          },\n        ],\n        menuType: [\n          { required: true, message: '请选择菜单类型', trigger: 'blur' },\n        ],\n        path: [{ required: true, validator: validatePath, trigger: 'blur' }],\n      }\n      if (this.ruleForm.menuType == 'C') {\n        rules.component = [\n          { required: true, validator: validateComponent, trigger: 'blur' },\n        ]\n      } else {\n        delete rules.component\n      }\n      return rules\n    },\n  },\n  methods: {\n    resetForm(formName) {\n      this.$refs[formName].resetFields()\n      this.$emit('close')\n    },\n    submitForm(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          addMenu({ ...this.ruleForm }).then(() => {\n            this.$emit('reload')\n            this.$emit('close')\n          })\n        }\n      })\n    },\n    addMenu(data, orderNum) {\n      const parentId = data.menuId\n      this.parentType = data.menuType\n      this.initData()\n      this.$nextTick(() => {\n        this.$set(this.ruleForm, 'parentId', parentId)\n        this.$set(this.ruleForm, 'orderNum', orderNum)\n      })\n    },\n    editMenu(id) {\n      this.initData()\n      getMenuInfo(id).then((res) => {\n        this.ruleForm = res.data\n      })\n    },\n    initData() {\n      this.ruleForm = {\n        menuName: '',\n        orderNum: null,\n        menuType: '',\n        path: '',\n        parentId: '0',\n        component: '',\n        query: '',\n        icon: 'el-icon-menu',\n        isFrame: 1,\n        isCache: 0,\n        status: 0,\n        visible: 0,\n      }\n      this.$nextTick(() => {\n        this.$refs['ruleForm'].resetFields()\n      })\n    },\n  },\n}\n</script>\n<style scoped lang=\"less\">\n.MenuForm {\n  padding: 16px;\n  display: flex;\n  flex-direction: column;\n}\n.MenuForm-switch {\n  display: grid;\n  grid-template-columns: 1fr 1fr;\n  align-items: center;\n  // justify-content: space-between;\n}\n.demo-ruleForm {\n  display: grid;\n  grid-column-gap: 16px;\n  grid-template-columns: 1fr 1fr;\n}\n.MenuForm-action {\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n}\n/deep/.el-form-item__content {\n  display: flex;\n  align-items: center;\n  height: 40px;\n}\n/deep/.el-input-number {\n  .el-input__inner {\n    text-align: left;\n  }\n}\n</style>\n","import mod from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MenuForm.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/thread-loader/dist/cjs.js!../../../../node_modules/babel-loader/lib/index.js??clonedRuleSet-40.use[1]!../../../../node_modules/@vue/vue-loader-v15/lib/index.js??vue-loader-options!./MenuForm.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./MenuForm.vue?vue&type=template&id=02592a8d&scoped=true&\"\nimport script from \"./MenuForm.vue?vue&type=script&lang=js&\"\nexport * from \"./MenuForm.vue?vue&type=script&lang=js&\"\nimport style0 from \"./MenuForm.vue?vue&type=style&index=0&id=02592a8d&prod&scoped=true&lang=less&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/@vue/vue-loader-v15/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"02592a8d\",\n  null\n  \n)\n\nexport default component.exports","import request from '@/utils/request'\nimport Setting from '@/utils/setting'\nimport store from '@/store'\nexport function addMenu(data) {\n  return request({\n    url: Setting.api + '/menus/addMenu',\n    method: 'POST',\n    data,\n  })\n}\nexport function deleteMenu(params) {\n  return request({\n    url: Setting.api + '/menus/deleteMenu',\n    method: 'delete',\n    params,\n  })\n}\nexport function getMenuTree() {\n  return request({\n    url: Setting.api + '/menus/getMenuTree',\n    method: 'get',\n  }).then((res) => {\n    store.dispatch('user/getMenuData')\n    return res\n  })\n}\nexport function getMenuInfo(id) {\n  return request({\n    url: Setting.api + '/menus/getMenuInfo/' + id,\n    method: 'get',\n  })\n}\nexport function sortMenu(parentId, data) {\n  return request({\n    url: Setting.api + '/menus/sortMenu?parentId=' + parentId,\n    method: 'POST',\n    data,\n  }).then((res) => {\n    store.dispatch('user/getMenuData')\n    return res\n  })\n}\n","import MenuManage from './MenuManage'\nexport default MenuManage\n"],"names":["render","_vm","this","_c","_self","staticClass","attrs","tree","defaultProps","on","handleNodeClick","onNodeDrop","scopedSlots","_u","key","fn","data","menuType","_e","menuName","staticStyle","$event","stopPropagation","addMenu","deleteMenu","showForm","ref","getMenu","close","staticRenderFns","name","components","MenuForm","menu","label","children","created","methods","getMenuTree","then","res","menuId","array2Tree","cloneDeep","id","node","$nextTick","$refs","editMenu","sort","length","ruleForm","insertNode","position","parentNode","parent","parentId","childSort","map","item","index","orderNum","sortMenu","catch","component","rules","model","value","callback","$$v","$set","expression","menuTree","parentType","path","query","icon","isFrame","isCache","status","visible","submitForm","_v","$emit","props","type","Array","default","emitPath","checkStrictly","computed","validatePath","rule","Error","validateComponent","required","message","trigger","min","max","validator","resetForm","formName","resetFields","validate","valid","initData","getMenuInfo","request","url","Setting","api","method","params","store","dispatch","MenuManage"],"sourceRoot":""}